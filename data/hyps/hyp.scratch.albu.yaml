# YOLOv5 ðŸš€ by Ultralytics, GPL-3.0 license
# Hyperparameters for low-augmentation COCO training from scratch
# python train.py --batch 64 --cfg yolov5n6.yaml --weights '' --data coco.yaml --img 640 --epochs 300 --linear
# See tutorials for hyperparameter evolution https://github.com/ultralytics/yolov5#tutorials

lr0:              0.01    # initial learning rate (SGD=1E-2, Adam=1E-3)
lrf:              0.01    # final OneCycleLR learning rate (lr0 * lrf)
momentum:         0.937   # SGD momentum/Adam beta1
weight_decay:     0.0005  # optimizer weight decay 5e-4
warmup_epochs:    3.0     # warmup epochs (fractions ok)
warmup_momentum:  0.8     # warmup initial momentum
warmup_bias_lr:   0.1     # warmup initial bias lr
box:              0.05    # box loss gain
cls:              0.5     # cls loss gain
cls_pw:           1.0     # cls BCELoss positive_weight
obj:              1.0     # obj loss gain (scale with pixels)
obj_pw:           1.0     # obj BCELoss positive_weight
iou_t:            0.20    # IoU training threshold
anchor_t:         4.0     # anchor-multiple threshold
fl_gamma:         0.0     # focal loss gamma (efficientDet default gamma=1.5)

transform:
  mosaic:     0.5   # per-sample probability of using 2x2 mosaic (only for train)
  mixup:      0.0   # per-sample probability of using mixup transform (only for train)
  copy_paste: 0.0   # per-sample probability of using copy_paste transform (only for train)
  
  transforms:       # list of transforms with their kwargs
                    # MUST NOT change image shape
    
    # Cutout Augmentation https://arxiv.org/abs/1708.04552
    - name: "Cutout"
      module: "utils.transforms.cutout"
      p: 0.3
      kwargs:
        num_holes:  4
        h_size:
          - 0.01
          - 0.10
        w_size:
          - 0.01
          - 0.10
        max_ioa:    0.3
        fill_value: 
          - 0
          - 255
    # Geometrical Augmentations
    - name: "VerticalFlip"
      p: 0.2
    - name: "HorizontalFlip"
      p: 0.5
    - name: "Affine"
      p: 1.0
      kwargs:
        mode: 0
        cval: # Gray 114
          - 114
          - 114
          - 114
        scale: 
          - 0.5
          - 2.0
        translate_percent:
          - -0.1
          - 0.1
        rotate: # degrees
          - -45
          - 45
        shear: # degrees
          - -20
          - 20
    # Color Transforms
    - name: "ColorJitter"
      p: 1.0
      kwargs:
        brightness: 0.2
        contrast: 0.2
        saturation: 0.2
        hue: 0.2
    - name: "ImageCompression"
      p: 0.1
    - name: "ToGray"
      p: 0.3
